<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="PetMarket - Perfil del Cliente" />
  <link rel="icon" href="/Imagenes/HuellaPerro.png" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link rel="stylesheet" href="/css/header.css" />
  <link rel="stylesheet" href="/css/footer.css" />
  <link rel="stylesheet" href="/css/assets.css" />
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="/css/buttons.css" />
  <title>Perfil Cliente</title>
</head>

<body>
  <%- include('partials/headerCliente') %>

    <main class="container-fluid mt-4">
      <div class="row">

        <aside class="col-md-3 mb-4">
          <div class="card shadow-sm border-0">
            <div class="card-body text-center">
              <img src="/Imagenes/foto_cliente_perfil.jpg" alt="Foto de perfil" class="rounded-circle border border-3"
                height="210" width="190" />
              <h5 class="mt-3 mb-1">
                <%= cliente?.nombre || 'Cliente' %>
              </h5>
              <p class="text-muted small">
                <%= cliente?.email || 'cliente@petmarket.com' %>
              </p>
            </div>

            <ul class="list-group list-group-flush">
              <li class="list-group-item">
                <a href="#" id="btn-configuracion-cliente" class="text-decoration-none d-flex align-items-center text-dark">
                  <i class="fas fa-user-cog me-2 text-primary"></i> Configuración básica
                </a>
              </li>
              <li class="list-group-item">
                <a href="#" class="text-decoration-none d-flex align-items-center text-dark" data-bs-toggle="modal"
                  data-bs-target="#cambiarContrasenaModalCliente">
                  <i class="fas fa-key me-2 text-warning"></i> Cambiar contraseña
                </a>
              </li>
              <li class="list-group-item">
                <a href="#" id="btn-pedidos-cliente" class="text-decoration-none d-flex align-items-center text-dark">
                  <i class="fas fa-box me-2 text-success"></i> Mis pedidos
                </a>
              </li>
              <li class="list-group-item">
                <a href="/" class="text-decoration-none d-flex align-items-center text-danger">
                  <i class="fas fa-sign-out-alt me-2"></i> Cerrar sesión
                </a>
              </li>
            </ul>
          </div>
        </aside>

        <section class="col-md-9">
          <div class="card mb-4" id="seccion-configuracion-cliente">
            <div class="card-header text-white">Configuración básica</div>
            <div class="card-body">
              <form id="formPerfilCliente" action="/perfil/cliente/actualizar" method="POST">
                <div class="row g-3">
                  <div class="col-md-6">
                    <label for="nombre" class="form-label">Nombre completo</label>
                    <input type="text" class="form-control form-control-lg" id="nombre" name="nombre" required
                      value="<%= cliente?.nombre || '' %>" placeholder="Tu Nombre" />
                  </div>
                  <div class="col-md-6">
                    <label for="correo" class="form-label">Correo electrónico</label>
                    <input type="email" class="form-control form-control-lg" id="correo" name="correo" required
                      value="<%= cliente?.email || '' %>" placeholder="Tu Correo Electrónico" />
                  </div>
                  <div class="col-md-6">
                    <label for="telefono" class="form-label">Teléfono</label>
                    <input type="text" class="form-control form-control-lg" id="telefono" name="telefono"
                      value="<%= cliente?.telefono || '' %>" placeholder="Tu Número de Teléfono" />
                  </div>
                  <div class="col-md-6">
                    <label for="direccion" class="form-label">Dirección</label>
                    <input type="text" class="form-control form-control-lg" id="direccion" name="direccion"
                      value="<%= cliente?.direccion || '' %>" placeholder="Tu Dirección" />
                  </div>
                </div>

                <div class="mt-4">
                  <button type="submit" class="btn btn-primary w-100 py-2 fs-5">
                    <i class="fas fa-save me-2"></i> Guardar cambios
                  </button>
                </div>
              </form>
            </div>
          </div>

          <div class="card d-none" id="seccion-pedidos-cliente">
            <div class="card-header text-white">Mis pedidos</div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table table-striped align-middle" id="tablaPedidosCliente">
                  <thead>
                    <tr>
                      <th>Nombre</th>
                      <th>Cantidad</th>
                      <th>Precio</th>
                      <th>Acciones</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- aquí puedes renderizar pedidos si los traes desde el servidor -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>

        </section>
      </div>
    </main>

    <div class="modal fade" id="cambiarContrasenaModalCliente" tabindex="-1" aria-labelledby="cambiarContrasenaModalClienteLabel"
      aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content custom-modal">
          <div class="modal-header custom-modal-header">
            <h5 class="modal-title" id="cambiarContrasenaModalClienteLabel">Cambiar contraseña</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
          </div>
          <div class="modal-body">
            <form id="formCambiarContrasenaCliente" autocomplete="off">
              <div class="mb-3">
                <label for="contrasenaAntigua" class="form-label">Contraseña actual</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="fas fa-lock"></i></span>
                  <input type="password" class="form-control" id="contrasenaAntigua" name="actual" required />
                </div>
              </div>
              <div class="mb-3">
                <label for="contrasenaNueva" class="form-label">Nueva contraseña</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="fas fa-lock"></i></span>
                  <input type="password" class="form-control" id="contrasenaNueva" name="nueva" required minlength="6" />
                </div>
              </div>
              <div class="mb-3">
                <label for="contrasenaConfirmar" class="form-label">Confirmar nueva contraseña</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="fas fa-lock"></i></span>
                  <input type="password" class="form-control" id="contrasenaConfirmar" name="confirmar" required minlength="6" />
                </div>
              </div>

              <div id="cambiarPassMensajeErrorCliente" class="alert alert-danger d-none text-center" role="alert"></div>
              <button type="submit" class="btn btn-primary w-100">Guardar</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="actualizacionExitosaModalCliente" tabindex="-1" aria-labelledby="actualizacionExitosaClienteLabel"
      aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content custom-modal">
          <div class="modal-header custom-modal-header">
            <h5 class="modal-title">¡Cambios guardados!</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
          </div>
          <div class="modal-body">
            El perfil fue actualizado correctamente.
          </div>
        </div>
      </div>
    </div>

    <%- include('partials/footer') %>

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js"></script>
      <script src="/js/perfil.js"></script>
</body>

</html>
